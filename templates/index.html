<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Drony – Panel GCS</title>
  
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>

  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; display: flex; height: 100vh; background: #2a2a2a; overflow: hidden; }
    
    #sidebar { width: 280px; background: #fff; border-right: 1px solid #ccc; padding: 15px; overflow-y: auto; z-index: 2000; display: flex; flex-direction: column; }
    #sidebar h3 { margin: 15px 0 8px; font-size: 0.85rem; color: #1322E6; border-bottom: 2px solid #1322E6; text-transform: uppercase; }
    
    .item { 
        padding: 10px; 
        border-radius: 4px; 
        cursor: pointer; 
        margin-bottom: 5px; 
        background: #f8f9fa; 
        font-size: 0.9rem; 
        border-left: 4px solid transparent; 
        transition: all 0.15s ease-out;
    }
    .item-content { display: flex; justify-content: space-between; align-items: center; width: 100%; }

    .item:hover { 
        background: #eef0ff; 
        border-left-width: 12px; 
    }

    .item.active { border-left-color: #28a745; font-weight: 600; } 
    .item.inactive { border-left-color: #c62828; color: #666; } 
    .item.detected { border-left-color: #ff9800; color: #555; background: #fff8e1; } 
    
    .item.selected { 
        background: #e6e8ff; 
        border-left-width: 12px; 
        border-left-color: #1322E6;
    }

    .list-btn { background: none; border: none; font-size: 1.1rem; cursor: pointer; padding: 0 5px; margin-left: 5px; transition: transform 0.2s; }
    .list-btn:hover { transform: scale(1.2); }
    .btn-delete { color: #aaa; }
    .btn-delete:hover { color: #dc3545; }
    .btn-add { color: #28a745; font-weight: bold; }
    .btn-add:hover { color: #1e7e34; }

    .sidebar-control { margin-top: auto; border-top: 1px solid #eee; padding-top: 15px; }
    button { width: 100%; padding: 10px; margin-bottom: 8px; cursor: pointer; border: none; border-radius: 4px; font-weight: 600; text-transform: uppercase; }
    #mission-btn { background: #28a745; color: white; }
    #generate-path-btn { background: #1322E6; color: white; }
    #clear-mission-btn { background: #dc3545; color: white; opacity: 0.5; }
    #clear-mission-btn:enabled { opacity: 1; }
    
    #map { flex: 1; z-index: 1; background: #222; }
     
    #gauges-container { position: absolute; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 1000; pointer-events: none; transition: opacity 0.3s; }
    .hidden { opacity: 0; }
    .gauge { width: 140px; height: 140px; background-color: rgba(15, 15, 15, 0.85); border-radius: 50%; border: 3px solid #555; position: relative; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    #attitude-indicator { background: #333; }
    #horizon-gradient { position: absolute; top: -100%; left: -100%; width: 300%; height: 300%; background: linear-gradient(to bottom, #00bfff 50%, #8b4513 50%); transition: transform 0.05s linear; z-index: 1; }
    .horizon-line { position: absolute; top: 50%; left: 0; width: 100%; height: 2px; background: rgba(255,255,255,0.8); }
    #crosshair { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 2px; background: #ffff00; z-index: 10; }
    #crosshair::after { content: ''; position: absolute; top: -6px; left: 50%; width: 2px; height: 12px; background: #ffff00; transform: translateX(-50%); }
    #compass { background: rgba(20, 20, 20, 0.9); color: white; }
    .compass-rose { width: 100%; height: 100%; position: relative; }
    .compass-label { position: absolute; font-size: 12px; color: #aaa; font-family: monospace; }
    .label-n { top: 8px; left: 50%; transform: translateX(-50%); color: #ff4444; }
    .label-e { right: 10px; top: 50%; transform: translateY(-50%); }
    .label-s { bottom: 8px; left: 50%; transform: translateX(-50%); }
    .label-w { left: 10px; top: 50%; transform: translateY(-50%); }
    .compass-needle { position: absolute; bottom: 50%; left: 50%; width: 4px; height: 35%; background: #ff4444; transform-origin: bottom center; transition: transform 0.1s cubic-bezier(0.25, 1, 0.5, 1); z-index: 5; }
    .hud-text { position: absolute; bottom: 15%; width: 100%; text-align: center; font-family: monospace; font-size: 11px; color: #0f0; text-shadow: 1px 1px 0 #000; z-index: 20; }
  </style>
</head>
<body>
  <div id="sidebar">
    <h3>Aktywne</h3>
    <div id="active-list"></div> <h3>Nieaktywne</h3>
    <div id="inactive-list"></div> <h3>Wykryte</h3>
    <div id="detected-list"></div> <div class="sidebar-control">
      <div id="mission-info" style="font-size:0.8rem; color:#666; margin-bottom:5px;"></div>
      
      <div class="control-group">
        <label style="font-size:0.75rem; font-weight:bold; color:#555;">Typ misji:</label>
        <select id="mission-type-select" style="width:100%; padding:5px; margin-top:5px;">
          <option value="lawnmower">Lawnmower (Obszar)</option>
          <option value="waypoints">Waypoints (Trasa)</option>
        </select>
      </div>

      <div id="density-control" style="margin: 10px 0; padding: 10px; background: #f0f0f0; display:none;">
        <label style="font-size:0.75rem; font-weight:bold;">Odstęp (m):</label>
        <input type="number" id="scan-distance" min="5" value="20" style="width:100%;">
      </div>

      <button id="mission-btn">Nowa misja</button>
      <button id="generate-path-btn">Generuj trasę</button>
      <button id="clear-mission-btn" disabled>Usuń misję</button>
    </div>
  </div>

  <div id="map"></div>

  <div id="gauges-container" class="hidden">
    <div id="attitude-indicator" class="gauge">
      <div id="horizon-gradient"><div class="horizon-line"></div></div>
      <div id="crosshair"></div>
      <div class="hud-text" id="hud-roll-pitch">R: 0° P: 0°</div>
    </div>
    <div id="compass" class="gauge">
      <div class="compass-rose">
        <span class="compass-label label-n">N</span><span class="compass-label label-e">E</span><span class="compass-label label-s">S</span><span class="compass-label label-w">W</span>
        <div class="compass-needle" id="compass-needle-el"></div>
      </div>
      <div class="hud-text" id="hud-yaw" style="bottom: 10px;">HDG: 0°</div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>